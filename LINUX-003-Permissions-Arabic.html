<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Linux Day 3/210 - Permissions & chmod + File Operations</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            direction: rtl;
            background: #0f172a;
            color: #e5e7eb;
            margin: 0;
            padding: 16px;
            line-height: 1.6;
        }
        h1, h2 { color: #38bdf8; }
        h3 { color: #60a5fa; }
        .block {
            border: 1px solid #334155;
            padding: 20px;
            margin: 20px 0;
            border-radius: 12px;
            background: #020617;
        }
        code {
            background: #111827;
            padding: 4px 8px;
            border-radius: 6px;
            direction: ltr;
            display: inline-block;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #111827;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
            direction: ltr;
            border-left: 4px solid #38bdf8;
        }
        .note {
            color: #a5b4fc;
            font-size: 0.9rem;
            font-style: italic;
        }
        ul { padding-right: 20px; }
        button {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            background: #22c55e;
            color: #0f172a;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
        }
        button:hover { background: #16a34a; }
        .quiz-q { margin-bottom: 20px; padding: 12px; background: #1e293b; border-radius: 8px; }
        .result-box {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
            background: #022c22;
            border: 2px solid #22c55e;
            display: none;
        }
        .command-title { border-bottom: 2px solid #38bdf8; padding-bottom: 8px; margin-bottom: 12px; }
        .scenario { background: #1e1b4b; padding: 12px; border-radius: 6px; margin: 8px 0; }
    </style>
</head>
<body>
    <h1>ğŸ”´ Linux Day 3/210 | Ø£Ø³Ø¨ÙˆØ¹ 1/30</h1>
    <h2>Permissions & chmod + File Operations</h2>

    <div class="block">
        <h3>ğŸ¯ Objectives</h3>
        <ul>
            <li>ÙÙ‡Ù… <strong>Permissions</strong> ÙÙŠ <code>ls -la</code> (rwxØŒ owner/group/others) Ù…Ø¹ Ø£Ù…Ø«Ù„Ø© Ø£Ù…Ù†ÙŠØ©</li>
            <li>Ø¥ØªÙ‚Ø§Ù† <code>chmod</code> Ù„ØªØºÙŠÙŠØ± permissions (Ø¹Ø¯Ø¯ÙŠ 755/symbolic u+x)</li>
            <li>Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ù„ÙØ§Øª: <code>touch</code>, <code>cp</code>, <code>mv</code>, <code>rm</code> Ù…Ø¹ Ø®ÙŠØ§Ø±Ø§Øª Ø¢Ù…Ù†Ø©</li>
            <li>Ø±Ø¨Ø· permissions Ø¨Ù€ <strong>Privilege Escalation</strong> Ùˆ <strong>SUID exploits</strong></li>
            <li>Mini-CTF: Ø¥Ù†Ø´Ø§Ø¡ exploit scenario Ø¨ØªØ¹Ø¯ÙŠÙ„ permissions</li>
        </ul>
    </div>

    <div class="block">
        <h3>ğŸ“š Theory</h3>
        <p><strong>Permissions</strong> ÙÙŠ Linux Ù‡ÙŠ Ù†Ø¸Ø§Ù… <strong>Discretionary Access Control (DAC)</strong> ÙŠØ­Ø¯Ø¯ <strong>r</strong> (read=4)ØŒ <strong>w</strong> (write=2)ØŒ <strong>x</strong> (execute=1) Ù„ÙƒÙ„ Ù…Ù† <strong>owner</strong>ØŒ <strong>group</strong>ØŒ <strong>others</strong>.</p>
        <p>ÙÙŠ <code>drwxr-xr-x</code>: <code>d</code>=directoryØŒ <code>rwx</code>=owner full controlØŒ <code>r-x</code>=group/others read+execute ÙÙ‚Ø·. Ø®Ù„ÙÙŠØ§Ù‹: kernel ÙŠØªØ­Ù‚Ù‚ permissions Ø¹Ø¨Ø± <strong>inode</strong> Ù‚Ø¨Ù„ syscall.</p>
        <p>ÙÙŠ Ø§Ù„Ø³ÙŠØ¨Ø±Ø§Ù†ÙŠ: Ø¥Ø°Ø§ <code>/bin/ping</code> Ù„Ø¯ÙŠÙ‡ <strong>SUID bit</strong> (<code>-rwsr-xr-x</code>) ÙŠØ¹Ù…Ù„ Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª root - <strong>exploits</strong> Ø´Ù‡ÙŠØ±Ø© Ù…Ø«Ù„ Dirty COW ØªØ³ØªØºÙ„ race conditions ÙÙŠ permissions.</p>
        <p><strong>chmod</strong> ÙŠØºÙŠØ± permissions Ø¹Ø¨Ø± <strong>chmod syscall</strong>. <strong>Numeric mode</strong> 755 = owner rwx(7), group/others rx(5). <strong>Symbolic</strong> <code>u+x</code> ØªØ¶ÙŠÙ execute Ù„Ù€ owner.</p>
        <p class="note">Ø®Ø·ÙˆØ±Ø©: <code>chmod 777 /etc/passwd</code> ÙŠØ³Ù…Ø­ Ù„Ù„Ù…Ù‡Ø§Ø¬Ù… ÙƒØªØ§Ø¨Ø© users Ø¬Ø¯Ø¯! <code>cp -p</code> ÙŠØ­Ø§ÙØ¸ permissions/timestamps Ù„Ù€ evidence preservation.</p>
    </div>

    <div class="block">
        <h3>ğŸ’» Practical Steps</h3>
        <p><strong>Step 1: ØªØ­Ù„ÙŠÙ„ Permissions</strong></p>
        <pre><code>ls -la /bin/ping           # -rwxr-xr-x 1 root root ... (normal)
ls -la /usr/bin/passwd     # -rwsr-xr-x 1 root root ... (SUID bit s!)
find /bin -perm -4000 2>/dev/null | head  # SUID binaries hunt</code></pre>
        <p class="note"><code>s</code> ÙÙŠ owner x = SUID. Ø®Ø·Ø£: <code>Permission denied</code> - Ø­Ù„: Ù„Ø§ sudo Ù„Ù€ enumeration</p>

        <p><strong>Step 2: chmod Ø¹Ù…Ù„ÙŠ</strong></p>
        <pre><code>touch testfile
ls -la testfile            # -rw-r--r-- 1 ali ali 0
chmod 755 testfile         # owner rwx, group/others rx
ls -la testfile            # -rwxr-xr-x
chmod u-x testfile         # symbolic: remove execute Ù…Ù† owner
rm testfile</code></pre>

        <p><strong>Step 3: File Operations</strong></p>
        <pre><code>mkdir ~/day3 && cd ~/day3
touch secret.txt flag.txt
cp secret.txt backup.txt -p     # preserve permissions/timestamps
mv flag.txt hidden_flag.txt
rm backup.txt
ls -la | grep flag</code></pre>
    </div>

    <div class="block">
        <h3>ğŸ”¬ Lab / Mini-CTF</h3>
        <p><strong>ØªÙ…Ø±ÙŠÙ† 1 (Ø¨Ø³ÙŠØ·):</strong> <code>touch ~/permtest && chmod 644 ~/permtest && ls -la ~/permtest</code>. Ø´Ø±Ø­ permissions Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©.</p>
        
        <p><strong>ØªÙ…Ø±ÙŠÙ† 2 (Ù…ØªÙˆØ³Ø·):</strong> <code>find /usr/bin -perm -4000 2>/dev/null | head -3</code>. Ù…Ø§ ÙˆØ¸ÙŠÙØ© <code>find</code> Ù‡Ù†Ø§ØŸ (PenTest enumeration)</p>
        
        <p><strong>ØªÙ…Ø±ÙŠÙ† 3 (CTF-style): SUID Exploit Simulation</strong></p>
        <pre><code>cd ~/day3
echo '#!/bin/bash\necho "Exploited!" > /tmp/pwned\ncat /etc/passwd' > exploit.sh
chmod 4755 exploit.sh           # SUID bit: 4xxx
ls -la exploit.sh               # -rwsr-xr-x
./exploit.sh                    # ÙŠØ¹Ù…Ù„ ÙƒÙ€ root!
FLAG: SUIDMastered</code></pre>
        <p class="note">Mini-CTF: Ù…Ø§ Ø§Ù„Ù€ permission Ø§Ù„Ø°ÙŠ Ø³Ù…Ø­ Ø§Ù„ØªÙ†ÙÙŠØ° ÙƒÙ€ rootØŸ (<code>s</code> ÙÙŠ owner x)</p>
    </div>

    <div class="block">
        <h3>ğŸ“¸ Screenshot Instructions</h3>
        <p><strong>Ø£Ø±Ø³Ù„:</strong></p>
        <ul>
            <li>Screenshot Terminal: <code>ls -la /bin/ping</code>, <code>find /bin -perm -4000 | head</code>, <code>chmod 755 testfile && ls -la</code>, Lab3 exploit</li>
            <li>Ø¥Ø¬Ø§Ø¨Ø§Øª Quiz Ø£Ø¯Ù†Ø§Ù‡</li>
            <li>Ø¬Ù…Ù„Ø©: "Ø¯Ø±Ø³ 3 Ù…ÙƒØªÙ…Ù„ âœ“ Ø³Ø§Ø¹Ø§Øª: 4"</li>
        </ul>
    </div>

    <div class="block">
        <h3>ğŸ“– Command Dictionary â€“ Ù‚Ø§Ù…ÙˆØ³ Ø£ÙˆØ§Ù…Ø± Ù‡Ø°Ø§ Ø§Ù„Ø¯Ø±Ø³</h3>
        
        <div class="command-title">
            <h4><code>ls -la</code></h4>
        </div>
        <p><strong>ØªØ¹Ø±ÙŠÙ:</strong> Long listing Ù…Ø¹ hidden files. <strong>Ø®Ù„ÙÙŠØ§Ù‹:</strong> stat() syscall Ù„Ù€ metadata.</p>
        <ul>
            <li><code>-l</code>: permissions/size/owner</li>
            <li><code>-a</code>: .files (dotfiles)</li>
            <li><code>-h</code>: human sizes (K/M/G)</li>
            <li><code>--color=auto</code>: colorize</li>
            <li>Ø£Ù…Ù†ÙŠ: ÙŠÙƒØ´Ù <code>.ssh/authorized_keys</code> backdoors</li>
        </ul>

        <div class="command-title">
            <h4><code>chmod</code></h4>
        </div>
        <p><strong>ØªØ¹Ø±ÙŠÙ:</strong> Change file mode bits. <strong>Ø®Ù„ÙÙŠØ§Ù‹:</strong> ÙŠØ­Ø¯Ø« inode permissions.</p>
        <ul>
            <li><code>755</code>: rwxr-xr-x standard</li>
            <li><code>u+x</code>: user execute only</li>
            <li><code>4755</code>: SUID + 755 (Ø®Ø·Ø±!)</li>
            <li><code>go-rwx</code>: remove all Ù…Ù† group/others</li>
            <li>Ø£Ù…Ù†ÙŠ: <code>chmod 0000 /bin/su</code> Ù„Ù€ DoS</li>
        </ul>

        <div class="command-title">
            <h4><code>find</code></h4>
        </div>
        <p><strong>ØªØ¹Ø±ÙŠÙ:</strong> Filesystem search. <strong>Ø®Ù„ÙÙŠØ§Ù‹:</strong> recursive DFS.</p>
        <ul>
            <li><code>-perm -4000</code>: SUID files</li>
            <li><code>2>/dev/null</code>: hide errors</li>
            <li><code>-user root</code>: root-owned</li>
            <li><code>-type f</code>: files only</li>
            <li>Ø£Ù…Ù†ÙŠ: SUID hunt ÙÙŠ privilege escalation</li>
        </ul>

        <div class="command-title">
            <h4><code>cp</code></h4>
        </div>
        <p><strong>ØªØ¹Ø±ÙŠÙ:</strong> Copy files/directories. <strong>Ø®Ù„ÙÙŠØ§Ù‹:</strong> read/write loop.</p>
        <ul>
            <li><code>-p</code>: preserve mode/timestamps</li>
            <li><code>-r</code>: recursive dirs</li>
            <li><code>-u</code>: update only newer</li>
            <li><code>-v</code>: verbose</li>
        </ul>
    </div>

    <div class="block">
        <h3>ğŸŒ Real Scenarios â€“ Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª ÙˆØ§Ù‚Ø¹ÙŠØ©</h3>
        
        <div class="scenario">
            <h4><strong>PenTester Enumeration</strong></h4>
            <pre><code>find / -perm -4000 2>/dev/null | grep -v /proc</code></pre>
            <p><strong>Ø´Ø±Ø­:</strong> <code>find</code> ÙŠØ¨Ø­Ø«ØŒ <code>-perm -4000</code> Ø£ÙŠ SUIDØŒ <code>2>/dev/null</code> ÙŠØ®ÙÙŠ Ø£Ø®Ø·Ø§Ø¡ permissionsØŒ <code>grep -v /proc</code> ÙŠØ³ØªØ«Ù†ÙŠ /proc noise. <strong>Ù†ØªÙŠØ¬Ø©:</strong> <code>/usr/bin/sudo</code> â†’ pentester ÙŠØ®ØªØ¨Ø± sudo misconfigs.</p>
        </div>

        <div class="scenario">
            <h4><strong>SysAdmin Hardening</strong></h4>
            <pre><code>chmod 755 /home/*/bin/* && find /home -perm -4000 -delete</code></pre>
            <p><strong>Ø´Ø±Ø­:</strong> <code>chmod 755</code> ÙŠØ¶Ø¨Ø· exec standardØŒ <code>find -perm -4000</code> ÙŠØ­Ø¯Ø¯ SUIDsØŒ <code>-delete</code> ÙŠØ­Ø°Ù. <strong>Ù†ØªÙŠØ¬Ø©:</strong> No user SUID â†’ sysadmin ÙŠÙ…Ù†Ø¹ LPE.</p>
        </div>

        <div class="scenario">
            <h4><strong>Incident Response Cleanup</strong></h4>
            <pre><code>cp -p /var/log/auth.log /tmp/ir_evidence && chmod 600 /tmp/ir_evidence</code></pre>
            <p><strong>Ø´Ø±Ø­:</strong> <code>cp -p</code> ÙŠØ­Ø§ÙØ¸ evidence chainØŒ <code>chmod 600</code> owner only access. <strong>Ù†ØªÙŠØ¬Ø©:</strong> Secure copy â†’ IR ÙŠØ­Ø§ÙØ¸ confidentiality.</p>
        </div>
    </div>

    <div class="block">
        <h3>ğŸ§  Quiz Ø§Ø­ØªØ±Ø§ÙÙŠ</h3>
        <div class="quiz-q">
            <strong>1. Ù…Ø§ Ù…Ø¹Ù†Ù‰ <code>drwxrwxrwt</code>ØŸ</strong><br>
            <label><input type="radio" name="q1" value="a"> d=dir, rwx all, t=sticky bit</label><br>
            <label><input type="radio" name="q1" value="b"> SUID binary</label><br>
            <label><input type="radio" name="q1" value="c"> root owned</label>
        </div>

        <div class="quiz-q">
            <strong>2. Ø£Ù…Ø± Ø§Ù„Ø¨Ø­Ø« SUID binariesØŸ</strong><br>
            <label><input type="radio" name="q2" value="a"> find / -perm -4000</label><br>
            <label><input type="radio" name="q2" value="b"> ls -la | grep root</label><br>
            <label><input type="radio" name="q2" value="c"> chmod 4000</label>
        </div>

        <div class="quiz-q">
            <strong>3. <code>cp -p</code> ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ØŸ</strong><br>
            <label><input type="radio" name="q3" value="a"> permissions/timestamps</label><br>
            <label><input type="radio" name="q3" value="b"> file content only</label><br>
            <label><input type="radio" name="q3" value="c"> owner only</label>
        </div>

        <div class="quiz-q">
            <strong>4. <code>chmod 4755</code> ÙŠØ¹Ù†ÙŠØŸ</strong><br>
            <label><input type="radio" name="q4" value="a"> SUID + 755</label><br>
            <label><input type="radio" name="q4" value="b"> owner rw only</label><br>
            <label><input type="radio" name="q4" value="c"> group execute</label>
        </div>

        <div class="quiz-q">
            <strong>5. Ù„Ù…Ø§Ø°Ø§ <code>/tmp</code> permissions <code>1777</code>ØŸ</strong><br>
            <label><input type="radio" name="q5" value="a"> Sticky bit ÙŠÙ…Ù†Ø¹ rm Ù…Ù„ÙØ§Øª Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†</label><br>
            <label><input type="radio" name="q5" value="b"> root only access</label><br>
            <label><input type="radio" name="q5" value="c"> SUID directory</label>
        </div>

        <button onclick="gradeQuiz()">Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        <div id="quizResult" class="result-box"></div>
        <p class="note">ğŸ“¸ Screenshot Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ + Terminal Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡ Ù„Ù€ Perplexity âœ“</p>
    </div>

    <script>
        function gradeQuiz() {
            let score = 0;
            const total = 5;
            
            const q1 = document.querySelector('input[name="q1"]:checked');
            const q2 = document.querySelector('input[name="q2"]:checked');
            const q3 = document.querySelector('input[name="q3"]:checked');
            const q4 = document.querySelector('input[name="q4"]:checked');
            const q5 = document.querySelector('input[name="q5"]:checked');
            
            if (q1 && q1.value === 'a') score++;
            if (q2 && q2.value === 'a') score++;
            if (q3 && q3.value === 'a') score++;
            if (q4 && q4.value === 'a') score++;
            if (q5 && q5.value === 'a') score++;
            
            const percent = Math.round((score / total) * 100);
            let grade = 'F';
            if (percent >= 90) grade = 'A';
            else if (percent >= 80) grade = 'B';
            else if (percent >= 70) grade = 'C';
            else if (percent >= 60) grade = 'D';
            
            const box = document.getElementById('quizResult');
            box.style.display = 'block';
            box.innerHTML = `
                <strong>Quiz Day 3 - Permissions & chmod</strong><br>
                ${score}/${total} ØµØ­ÙŠØ­<br>
                ${percent}% - Ø¯Ø±Ø¬Ø©: ${grade}<br><br>
                ğŸ“¸ Ø®Ø° Screenshot Ù„Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚ + Terminal ÙˆØ£Ø±Ø³Ù„ Ù„Ù€ Perplexity
            `;
        }
    </script>
</body>
</html>
